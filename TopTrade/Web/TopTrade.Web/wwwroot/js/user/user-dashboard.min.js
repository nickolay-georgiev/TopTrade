function showRemoveStockButton(n){if(n.target.tagName.toLowerCase()==="i"&&n.target.childElementCount>0){[...n.target.children].forEach(n=>n.remove());return}if(n.target.tagName.toLowerCase()!=="div"){const t=document.createElement("div");t.classList.add("remove-stock-div");const i=document.createElement("span");i.textContent="Remove";t.appendChild(i);n.target.appendChild(t);t.addEventListener("click",removeStockButton)}}function removeStockButton(){this.parentElement.parentElement.parentElement.remove()}async function stockSearch(){const h=document.querySelector("[name=__RequestVerificationToken]").value;let c=await fetch("api/stockSearch",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":h},body:JSON.stringify("test")}),l=await c.json();console.log(l);const o=document.querySelector("div.search-bar div.form-group"),a=document.querySelector("div.close-search-bar");a.removeAttribute("hidden");const y=o.querySelector("input"),r=document.createElement("div");r.classList.add("search-result-div");const u=document.createElement("div");u.classList.add("d-flex","flex-row");const f=document.createElement("img");f.src=`//logo.clearbit.com/${"spotify"}.com`;f.classList.add("company-logo");const e=document.createElement("div");e.classList.add("ml-2");const t=document.createElement("p");t.textContent="AAPL";t.classList.add("mb-0");t.classList.add("font-weight-bold");const i=document.createElement("p");i.textContent="APPLE";i.classList.add("mb-0");i.classList.add("small");const n=document.createElement("div");n.style.cursor="pointer";n.style.background="green";n.style.color="white";const v=document.createElement("i");v.classList.add("fas","fa-plus");const s=document.createElement("i");s.classList.add("fas","fa-check");n.append(s);n.addEventListener("click",addStockToWatchList);e.append(t,i);u.append(f,e);r.append(u,n);o.append(r)}function addStockToWatchList(){const t=`
              <td>
                  <img class="company-logo" src="//logo.clearbit.com/${"spotify"}.com" alt="">
                  <div>
                      <p class="mb-0 ml-2 text-uppercase font-weight-bold stock-ticker">${"RR.L"}</p>
                      <p class="mb-0 ml-2 small stock-name">${"Rolls-Royce"}</p>
                  </div>
              </td>
              <td>
                  <p class="mb-0 ml-2 font-weight-bold stock-price-up">${25..toFixed(2)}</p>
                  <p class="mb-0 ml-2 font-weight-bold small stock-price-down">(${4..toFixed(2)})&#37</p>
              </td>
              <td>
                  <img class="stock-line-chart" src="${"./img/chart.jpg"}" alt="">
              </td>
              <td>
                  <div class="input-group sell-button order-type-button">
                      <div class="input-group-prepend">
                          <div class="input-group-text font-weight-bold" id="btnGroupAddon">S</div>
                      </div>
                      <button class="form-control font-weight-bold price" data-target="#buy-button"  data-toggle="modal">${10..toFixed(2)}</button>
                  </div>
              </td>
              <td>
                  <div class="input-group buy-button order-type-button">
                      <div class="input-group-prepend">
                          <div class="input-group-text font-weight-bold" id="btnGroupAddon">B</div>
                      </div>
                      <button class="form-control font-weight-bold" data-target="#buy-button"
                          data-toggle="modal">${20..toFixed(2)}</button>
                  </div>
              </td>
              <td>
                  <span>mdo</span>
                  <i class="fas fa-ellipsis-v remove-stock-button"></i>
              </td>`,n=document.createElement("tr");n.innerHTML=t;n.lastElementChild.lastElementChild.addEventListener("click",showRemoveStockButton);document.querySelector("tbody").appendChild(n)}function closeSearchBar(){const n=document.querySelector("div.search-bar div.form-group"),t=document.querySelector("div.close-search-bar");console.log(n);[...n.children].slice(1).forEach(n=>n.remove());t.setAttribute("hidden",!0)}function configureOrder(n){let t;const r=document.querySelector(".input-stock-price"),u=document.querySelector(".total-amount"),f=document.querySelector(".stock-quantity"),e=document.querySelector(".stock-ticker").textContent,o=document.querySelector(".stock-name").textContent,s=document.querySelector(".company-logo").src,h=document.querySelector(".order-stock-name");h.textContent=o;let i;n.target.classList.contains("configure-order-button")?(n.preventDefault(),i=n.target.textContent[0].toLowerCase(),t=Number(document.querySelector(".price").textContent)):(i=n.target.previousElementSibling.firstElementChild.textContent,t=t=Number(n.target.textContent));i.toLowerCase()=="b"?([...document.querySelectorAll(".order-type")].forEach(n=>{n.textContent="buy"}),document.querySelector(".order-buy-btn").classList.add("active"),document.querySelector(".order-sell-btn").classList.remove("active")):([...document.querySelectorAll(".order-type")].forEach(n=>{n.textContent="sell"}),document.querySelector(".order-sell-btn").classList.add("active"),document.querySelector(".order-buy-btn").classList.remove("active"));document.querySelector(".order-company-logo").src=s;[...document.querySelectorAll(".order-stock-ticker")].forEach(n=>{n.textContent=e});f.addEventListener("input",n=>{const i=Number(n.target.value);if(!(i<0)){const r=document.querySelector(".execute-order-button");r.removeAttribute("disabled");const f=t*i;u.placeholder=`$ ${f.toFixed(2)}`;const e=document.querySelector(".order-details-price");e.textContent=`${f.toFixed(2)}`;const o=document.querySelector(".order-details-quantity");o.textContent=i;i==0&&(r.disabled=!0)}});r.placeholder=`${t.toFixed(2)}`}function makeDeposit(n){n.preventDefault();const t=document.querySelector(".deposit-amount").value.trim(),i=document.querySelector(".card-number").value,r=document.querySelector(".card-expiry-date").value,u=document.querySelector(".card-cvv-number").value,f=document.querySelector(".card-first-name").value.trim(),e=document.querySelector(".card-middle-name").value.trim(),o=document.querySelector(".card-last-name").value.trim(),s=document.querySelector("[name=__RequestVerificationToken]").value;var h={depositAmount:t,cardNumber:i,cardExpiryDate:r,cardCvvNumber:u,cardFirstName:f,cardMiddleName:e,cardLastName:o};fetch("api/deposit",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":s},body:JSON.stringify(h)}).then(n=>{console.log(n)})}document.querySelectorAll(".remove-stock-button").forEach(n=>n.addEventListener("click",showRemoveStockButton));document.querySelector(".search-icon-button").addEventListener("click",stockSearch);document.querySelector("div.close-search-bar").addEventListener("click",closeSearchBar);[...document.querySelectorAll(".order-type-button")].forEach(n=>{n.addEventListener("click",configureOrder)});document.querySelector(".make-deposit-button").addEventListener("click",makeDeposit);document.querySelector(".card-number").addEventListener("input",function(){var n=this.value.split("-").join("");n.length>0&&(n=n.match(new RegExp(".{1,4}","g")).join("-"));this.value=n});document.querySelector(".card-expiry-date").addEventListener("input",function(){var n=this.value;n.length==2&&(n+=" / ");this.value=n});